[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Modelos Lineares I - Seminário",
    "section": "",
    "text": "Introdução\nEste material faz parte da disciplina LCE5861 - Modelos Lineares, ministrada pelo prof. dr. César Gonçalves de Lima na ESALQ/USP para o programa de Pós Graduação em Estatística e Experimentação Agronômica, curso de mestrado no ano de 2024."
  },
  {
    "objectID": "exemplo1.html#vetores-e-matriz",
    "href": "exemplo1.html#vetores-e-matriz",
    "title": "\n1  Exemplo\n",
    "section": "\n1.1 Vetores e Matriz",
    "text": "1.1 Vetores e Matriz\n\n\nR\nSAS\n\n\n\nPara criar vetores no R, definimos um nome para cada vetor (y1, y2, y3 e y4), em seguida, utilizamos o operador &lt;- e a função c() para atribuir valores a cada um dos objetos (vetores). Dentro de c(), declaramos seus valores, separados por vírgula.\n\ny1 &lt;- c(72,60,56,41,32,30,39,42,37,33,32,63,54,47,91,56,79,81,78,46,39,32,60,35,39,50,43,48)\n\ny2 &lt;- c(66,53,57,29,32,35,39,43,40,29,30,45,46,51,79,68,65,80,55,38,35,30,50,37,36,34,37,54)\n\ny3 &lt;- c(76,66,64,36,35,34,31,31,31,27,34,74,60,52,100,47,70,68,67,37,34,30,67,48,39,37,39,57)\n\ny4 &lt;- c(77,63,58,38,36,26,27,25,25,36,28,63,52,43,75,50,61,58,60,38,37,32,54,39,31,40,50,43)\n\nCom a função cbind() juntamos os vetores y1, y2, y3 e y4, salvando-os em um objeto chamado Y. Utilizando a função colnames(), alteramos os nomes dos vetores (\"North\", \"East\", \"South\", \"West\").\n\nY &lt;- cbind(y1, y2, y3, y4)\ncolnames(Y) &lt;- c(\"North\", \"East\", \"South\", \"West\")\nY\n\n      North East South West\n [1,]    72   66    76   77\n [2,]    60   53    66   63\n [3,]    56   57    64   58\n [4,]    41   29    36   38\n [5,]    32   32    35   36\n [6,]    30   35    34   26\n [7,]    39   39    31   27\n [8,]    42   43    31   25\n [9,]    37   40    31   25\n[10,]    33   29    27   36\n[11,]    32   30    34   28\n[12,]    63   45    74   63\n[13,]    54   46    60   52\n[14,]    47   51    52   43\n[15,]    91   79   100   75\n[16,]    56   68    47   50\n[17,]    79   65    70   61\n[18,]    81   80    68   58\n[19,]    78   55    67   60\n[20,]    46   38    37   38\n[21,]    39   35    34   37\n[22,]    32   30    30   32\n[23,]    60   50    67   54\n[24,]    35   37    48   39\n[25,]    39   36    39   31\n[26,]    50   34    37   40\n[27,]    43   37    39   50\n[28,]    48   54    57   43\n\n\nCom a função class(), constatamos que o objeto Y é uma matriz (matrix).\n\nclass(Y)\n\n[1] \"matrix\" \"array\" \n\n\n\n\n\nproc iml;\n\ny1 = {72,60,56,41,32,30,39,42,37,33,32,63,54,47, 91,56,79,81,78,46, 39,32,60,35,39,50,43,48};\n\ny2 = {66,53,57,29,32,35,39,43,40,29,30,45,46,51, 79,68,65,80,55,38, 35,30,50,37,36,34,37,54};\n\ny3 = {76,66,64,36,35,34,31,31,31,27,34,74,60,52,100,47,70,68,67,37, 34,30,67,48,39,37,39,57};\n\ny4 = {77,63,58,38,36,26,27,25,25,36,28,63,52,43, 75,50,61,58,60,38, 37,32,54,39,31,40,50,43};\n\n\nY = y1||y2||y3||y4;\ncreate Cork var {North East South West};\nappend from Y;\nClose Cork;"
  },
  {
    "objectID": "exemplo1.html#matriz-de-covariâncias-e-correlações",
    "href": "exemplo1.html#matriz-de-covariâncias-e-correlações",
    "title": "\n1  Exemplo\n",
    "section": "\n1.2 Matriz de Covariâncias e Correlações",
    "text": "1.2 Matriz de Covariâncias e Correlações\n\n\nR\nSAS\n\n\n\nAs funções nrow() e ncol() nos retornam o número de linhas e colunas de um objeto, respectivamente.\n\nn &lt;- nrow(Y)\np &lt;- ncol(Y)\n\nn; p\n\n[1] 28\n\n\n[1] 4\n\n\nNo caso da matriz Y, ela apresenta dimensão \\(28 \\times 4\\).\nA função diag() cria uma matriz identidade. Basta inserirmos dentro da função a dimensão da matriz.\n\nIn &lt;- diag(n)\nIn\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]\n [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0\n [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0\n [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0\n [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0\n [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0\n [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0\n [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0\n [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0\n [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0\n[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0\n[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0\n[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0\n[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1\n[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[21,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[22,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[23,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[24,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[25,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[26,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[27,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n[28,]    0    0    0    0    0    0    0    0    0     0     0     0     0\n      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]\n [1,]     0     0     0     0     0     0     0     0     0     0     0     0\n [2,]     0     0     0     0     0     0     0     0     0     0     0     0\n [3,]     0     0     0     0     0     0     0     0     0     0     0     0\n [4,]     0     0     0     0     0     0     0     0     0     0     0     0\n [5,]     0     0     0     0     0     0     0     0     0     0     0     0\n [6,]     0     0     0     0     0     0     0     0     0     0     0     0\n [7,]     0     0     0     0     0     0     0     0     0     0     0     0\n [8,]     0     0     0     0     0     0     0     0     0     0     0     0\n [9,]     0     0     0     0     0     0     0     0     0     0     0     0\n[10,]     0     0     0     0     0     0     0     0     0     0     0     0\n[11,]     0     0     0     0     0     0     0     0     0     0     0     0\n[12,]     0     0     0     0     0     0     0     0     0     0     0     0\n[13,]     0     0     0     0     0     0     0     0     0     0     0     0\n[14,]     1     0     0     0     0     0     0     0     0     0     0     0\n[15,]     0     1     0     0     0     0     0     0     0     0     0     0\n[16,]     0     0     1     0     0     0     0     0     0     0     0     0\n[17,]     0     0     0     1     0     0     0     0     0     0     0     0\n[18,]     0     0     0     0     1     0     0     0     0     0     0     0\n[19,]     0     0     0     0     0     1     0     0     0     0     0     0\n[20,]     0     0     0     0     0     0     1     0     0     0     0     0\n[21,]     0     0     0     0     0     0     0     1     0     0     0     0\n[22,]     0     0     0     0     0     0     0     0     1     0     0     0\n[23,]     0     0     0     0     0     0     0     0     0     1     0     0\n[24,]     0     0     0     0     0     0     0     0     0     0     1     0\n[25,]     0     0     0     0     0     0     0     0     0     0     0     1\n[26,]     0     0     0     0     0     0     0     0     0     0     0     0\n[27,]     0     0     0     0     0     0     0     0     0     0     0     0\n[28,]     0     0     0     0     0     0     0     0     0     0     0     0\n      [,26] [,27] [,28]\n [1,]     0     0     0\n [2,]     0     0     0\n [3,]     0     0     0\n [4,]     0     0     0\n [5,]     0     0     0\n [6,]     0     0     0\n [7,]     0     0     0\n [8,]     0     0     0\n [9,]     0     0     0\n[10,]     0     0     0\n[11,]     0     0     0\n[12,]     0     0     0\n[13,]     0     0     0\n[14,]     0     0     0\n[15,]     0     0     0\n[16,]     0     0     0\n[17,]     0     0     0\n[18,]     0     0     0\n[19,]     0     0     0\n[20,]     0     0     0\n[21,]     0     0     0\n[22,]     0     0     0\n[23,]     0     0     0\n[24,]     0     0     0\n[25,]     0     0     0\n[26,]     1     0     0\n[27,]     0     1     0\n[28,]     0     0     1\n\n\n\\[\n\\mathbf{I}_{(n)} =\n  \\begin{bmatrix}\n   1 & 0 & 0 & \\dots & 0 \\\\\n   0 & 1 & 0 & \\dots & 0 \\\\\n   0 & 0 & 1 &\\dots & 0 \\\\\n   \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n   0 & 0 & 0 & \\dots & 1\n   \\end{bmatrix}\n\\]\nCom a função matrix(), podemos criar qualquer tipo de matriz, vetor ou escalar. Para isso, utilizamos três argumentos dentro da função:\n\ndata =: os elementos que compõem a matriz;\nnrow =: número de linhas da matriz;\nncol =: número de colunas da matriz.\n\n\njn &lt;- matrix(data = 1, nrow = n, ncol = 1)\njn\n\n      [,1]\n [1,]    1\n [2,]    1\n [3,]    1\n [4,]    1\n [5,]    1\n [6,]    1\n [7,]    1\n [8,]    1\n [9,]    1\n[10,]    1\n[11,]    1\n[12,]    1\n[13,]    1\n[14,]    1\n[15,]    1\n[16,]    1\n[17,]    1\n[18,]    1\n[19,]    1\n[20,]    1\n[21,]    1\n[22,]    1\n[23,]    1\n[24,]    1\n[25,]    1\n[26,]    1\n[27,]    1\n[28,]    1\n\nJnn &lt;- matrix(data = 1, nrow = n, ncol = n)\nJnn\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]\n [1,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [2,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [3,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [4,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [5,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [6,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [7,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [8,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n [9,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[10,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[11,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[12,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[13,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[14,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[15,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[16,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[17,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[18,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[19,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[20,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[21,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[22,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[23,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[24,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[25,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[26,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[27,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n[28,]    1    1    1    1    1    1    1    1    1     1     1     1     1\n      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]\n [1,]     1     1     1     1     1     1     1     1     1     1     1     1\n [2,]     1     1     1     1     1     1     1     1     1     1     1     1\n [3,]     1     1     1     1     1     1     1     1     1     1     1     1\n [4,]     1     1     1     1     1     1     1     1     1     1     1     1\n [5,]     1     1     1     1     1     1     1     1     1     1     1     1\n [6,]     1     1     1     1     1     1     1     1     1     1     1     1\n [7,]     1     1     1     1     1     1     1     1     1     1     1     1\n [8,]     1     1     1     1     1     1     1     1     1     1     1     1\n [9,]     1     1     1     1     1     1     1     1     1     1     1     1\n[10,]     1     1     1     1     1     1     1     1     1     1     1     1\n[11,]     1     1     1     1     1     1     1     1     1     1     1     1\n[12,]     1     1     1     1     1     1     1     1     1     1     1     1\n[13,]     1     1     1     1     1     1     1     1     1     1     1     1\n[14,]     1     1     1     1     1     1     1     1     1     1     1     1\n[15,]     1     1     1     1     1     1     1     1     1     1     1     1\n[16,]     1     1     1     1     1     1     1     1     1     1     1     1\n[17,]     1     1     1     1     1     1     1     1     1     1     1     1\n[18,]     1     1     1     1     1     1     1     1     1     1     1     1\n[19,]     1     1     1     1     1     1     1     1     1     1     1     1\n[20,]     1     1     1     1     1     1     1     1     1     1     1     1\n[21,]     1     1     1     1     1     1     1     1     1     1     1     1\n[22,]     1     1     1     1     1     1     1     1     1     1     1     1\n[23,]     1     1     1     1     1     1     1     1     1     1     1     1\n[24,]     1     1     1     1     1     1     1     1     1     1     1     1\n[25,]     1     1     1     1     1     1     1     1     1     1     1     1\n[26,]     1     1     1     1     1     1     1     1     1     1     1     1\n[27,]     1     1     1     1     1     1     1     1     1     1     1     1\n[28,]     1     1     1     1     1     1     1     1     1     1     1     1\n      [,26] [,27] [,28]\n [1,]     1     1     1\n [2,]     1     1     1\n [3,]     1     1     1\n [4,]     1     1     1\n [5,]     1     1     1\n [6,]     1     1     1\n [7,]     1     1     1\n [8,]     1     1     1\n [9,]     1     1     1\n[10,]     1     1     1\n[11,]     1     1     1\n[12,]     1     1     1\n[13,]     1     1     1\n[14,]     1     1     1\n[15,]     1     1     1\n[16,]     1     1     1\n[17,]     1     1     1\n[18,]     1     1     1\n[19,]     1     1     1\n[20,]     1     1     1\n[21,]     1     1     1\n[22,]     1     1     1\n[23,]     1     1     1\n[24,]     1     1     1\n[25,]     1     1     1\n[26,]     1     1     1\n[27,]     1     1     1\n[28,]     1     1     1\n\n\nNos casos anteriores, criamos o vetor coluna de 1’s jn de dimensão \\(28 \\times 1\\) e a matriz de 1’s Jnn de dimensão \\(28 \\times 28\\).\n\\[\nj_n = \\mathbf{j}_{(28 \\times 1)} = [1,1,...,1]'\n\\]\n\\[\nJnn = \\mathbf{J}_{(28 \\times 28)} =\n  \\begin{bmatrix}\n   1 & 1 & 1 & \\dots & 1 \\\\\n   1 & 1 & 1 & \\dots & 1 \\\\\n   1 & 1 & 1 &\\dots & 1 \\\\\n   \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n   1 & 1 & 1 & \\dots & 1\n   \\end{bmatrix}\n\\]\nA seguir, calcularemos a matriz de variâncias e covariâncias amostrais, dada pela equação:\n\\[\\mathbf{\\Sigma} = \\frac{1}{n-1} \\mathbf{Y}'(\\mathbf{I} - \\frac{1}{n}J) \\mathbf{Y}\\]\n\nSigma &lt;- (1 / (n - 1)) * t(Y) %*% (In - (1/n) * Jnn) %*% Y\nSigma\n\n         North     East    South     West\nNorth 290.4061 223.7526 288.4378 226.2712\nEast  223.7526 219.9299 229.0595 171.3743\nSouth 288.4378 229.0595 350.0040 259.5410\nWest  226.2712 171.3743 259.5410 226.0040\n\n\nA função t() realiza a transposição de uma matriz ou vetor. Já o operador %*% realiza a multiplicação entre duas matrizes ou vetores conformes.\nNo R, temos a função cov() que realiza o cálculo da matriz de variâncias e covariâncias.\n\ncov(Y)\n\n         North     East    South     West\nNorth 290.4061 223.7526 288.4378 226.2712\nEast  223.7526 219.9299 229.0595 171.3743\nSouth 288.4378 229.0595 350.0040 259.5410\nWest  226.2712 171.3743 259.5410 226.0040\n\n\n\\[\n\\mathbf{\\Sigma} =\n  \\begin{bmatrix}\n   \\sigma^2_1 & \\sigma_{12} & \\sigma_{13} & \\dots & \\sigma_{1p} \\\\\n   \\sigma_{21} & \\sigma^2_2 & \\sigma_{23} & \\dots & \\sigma_{2p} \\\\\n   \\sigma_{31} & \\sigma_{32} & \\sigma^2_3 &\\dots & \\sigma_{p3} \\\\\n   \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n   \\sigma_{p1} & \\sigma_{p2} & \\sigma_{p3} & \\dots & \\sigma^2_p\n   \\end{bmatrix}\n\\]\nPara calcular a matriz de correlação (\\(\\mathbf{\\rho}_{ij}\\)), utilizamos a seguinte expressão:\n\\[\\mathbf{\\rho}_{ij} = \\mathbf{D}_{\\sigma}^{-1} \\mathbf{\\Sigma}  \\mathbf{D}_{\\sigma}^{-1}\\]\nem que \\(\\mathbf{D}_{\\sigma}\\) é a raiz quadrada das variâncias, ou seja, a raiz quadrada da diagonal da matriz de variâncias e covariâncias (\\(\\mathbf{\\Sigma}\\)).\n\nD &lt;- sqrt(diag(Sigma))\nD\n\n   North     East    South     West \n17.04131 14.83003 18.70839 15.03343 \n\ncorr &lt;- solve(diag(D)) %*% Sigma %*% solve(diag(D))\ncorr\n\n          [,1]      [,2]      [,3]      [,4]\n[1,] 1.0000000 0.8853667 0.9047173 0.8832188\n[2,] 0.8853667 1.0000000 0.8256001 0.7686801\n[3,] 0.9047173 0.8256001 1.0000000 0.9228082\n[4,] 0.8832188 0.7686801 0.9228082 1.0000000\n\n\nA função sqrt() realiza a operação raiz quadrada. Já a solve(), calcula a inversa de uma matriz.\nNo R, temos a função cor() que realiza o cálculo da matriz de correlação.\n\ncor(Y)\n\n          North      East     South      West\nNorth 1.0000000 0.8853667 0.9047173 0.8832188\nEast  0.8853667 1.0000000 0.8256001 0.7686801\nSouth 0.9047173 0.8256001 1.0000000 0.9228082\nWest  0.8832188 0.7686801 0.9228082 1.0000000\n\n\n\\[\n\\mathbf{\\rho} =\n  \\begin{bmatrix}\n   1 & \\rho_{12} & \\rho_{13} & \\dots & \\rho_{1p} \\\\\n   \\rho_{21} & 1 & \\rho_{23} & \\dots & \\rho_{2p} \\\\\n   \\rho_{31} & \\rho_{32} & 1 &\\dots & \\rho_{p3} \\\\\n   \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n   \\rho_{p1} & \\rho_{p2} & \\rho_{p3} & \\dots & 1\n   \\end{bmatrix}\n\\]\nPor fim, a partir da matriz de correlação (\\(\\mathbf{\\rho}_{ij}\\)), podemos retornar para a matriz de variâncias e covariâncias (\\(\\mathbf{\\Sigma}\\)) a partir da seguinte equação:\n\\[\n\\mathbf{\\Sigma} = \\mathbf{D}_{\\sigma} \\mathbf{\\rho}_{ij} \\mathbf{D}_{\\sigma}\n\\]\n\nVerifica &lt;- diag(D) %*% corr %*% diag(D)\nVerifica\n\n         [,1]     [,2]     [,3]     [,4]\n[1,] 290.4061 223.7526 288.4378 226.2712\n[2,] 223.7526 219.9299 229.0595 171.3743\n[3,] 288.4378 229.0595 350.0040 259.5410\n[4,] 226.2712 171.3743 259.5410 226.0040\n\n\n\n\n\np = ncol(Y);\nn = nrow(Y);\nIn = I(n);\njn = j(n,1,1);\nJnn = J(n,n,1);\nSigma = (1/(n-1))*t(Y)*(In-(1/n)*Jnn)*Y;\nD = sqrt(diag(Sigma));\ncorr = inv(D)*Sigma*inv(D);\nVerifica = D*corr*D;\ntitle 'Matriz de variâncias e covariâncias amostrais utilizando proc iml';\nprint ,,Sigma[format=8.4],, 'Matriz de correlações:' ,, corr[format=8.5],, Verifica[format=8.4];"
  },
  {
    "objectID": "exemplo1.html#distância-de-mahalanobis-distância-padronizada",
    "href": "exemplo1.html#distância-de-mahalanobis-distância-padronizada",
    "title": "\n1  Exemplo\n",
    "section": "\n1.3 Distância de Mahalanobis (Distância padronizada)",
    "text": "1.3 Distância de Mahalanobis (Distância padronizada)\n\n\nR\nSAS\n\n\n\nPrimeiramente, calcularemos o vetor de médias (\\(\\mathbf{\\mu}\\)) da matriz \\(\\mathbf{Y}\\).\n\\[\\mathbf{\\mu} = \\frac{1}n \\mathbf{j}' \\mathbf{Y}\\]\n\nmi &lt;- (1/n) * t(jn) %*% Y\nmi\n\n        North     East    South     West\n[1,] 50.53571 46.17857 49.67857 45.17857\n\n\nCom o vetor de médias (\\(\\mathbf{\\mu}\\)), calcularemos a distância de Mahalanobis (\\(DM\\)), dada pela seguinte expressão:\n\\[\nDM = (y - \\mathbf{\\mu})' \\mathbf{\\Sigma} (y - \\mathbf{\\mu})\n\\]\n\nDM2 &lt;- rep(0, n)\nfor (i in 1:n) {\n  yi &lt;- Y[i,]\n  DM &lt;- as.numeric((yi - mi) %*% solve(Sigma) %*% t(yi - mi))\n  DM2[i] &lt;- DM\n}\nDM2\n\n [1]  7.619457  2.509622  2.714316  2.521244  1.744186  3.069220  2.212975\n [8]  4.114008  2.800802  3.315503  2.099698  5.891095  1.062421  1.691059\n[15]  8.996903 10.409160  4.075630  8.576964  7.124169  1.434898  1.086315\n[22]  1.372791  2.110873  3.913168  1.647245  4.667263  5.412107  3.806908\n\n\nNo R, podemos utilizar a função mahalanobis() para calcular a distância de Mahalanobis. Como argumentos, temos:\n\nx =: matriz utilizada para o cálculo;\ncenter =: o vetor de médias (\\(\\mu\\));\ncov =: a matriz de variâncias e covariâncias (\\(\\Sigma\\)).\n\n\nmahalanobis(x = Y, center = mi, cov = Sigma)\n\n [1]  7.619457  2.509622  2.714316  2.521244  1.744186  3.069220  2.212975\n [8]  4.114008  2.800802  3.315503  2.099698  5.891095  1.062421  1.691059\n[15]  8.996903 10.409160  4.075630  8.576964  7.124169  1.434898  1.086315\n[22]  1.372791  2.110873  3.913168  1.647245  4.667263  5.412107  3.806908\n\n\nOrdenando os valores do vetor da distância de Mahalanobis, temos:\n\nrank &lt;- rank(DM2)\ndata.frame(Y, DM2, rank)\n\n   North East South West       DM2 rank\n1     72   66    76   77  7.619457   25\n2     60   53    66   63  2.509622   11\n3     56   57    64   58  2.714316   13\n4     41   29    36   38  2.521244   12\n5     32   32    35   36  1.744186    7\n6     30   35    34   26  3.069220   15\n7     39   39    31   27  2.212975   10\n8     42   43    31   25  4.114008   20\n9     37   40    31   25  2.800802   14\n10    33   29    27   36  3.315503   16\n11    32   30    34   28  2.099698    8\n12    63   45    74   63  5.891095   23\n13    54   46    60   52  1.062421    1\n14    47   51    52   43  1.691059    6\n15    91   79   100   75  8.996903   27\n16    56   68    47   50 10.409160   28\n17    79   65    70   61  4.075630   19\n18    81   80    68   58  8.576964   26\n19    78   55    67   60  7.124169   24\n20    46   38    37   38  1.434898    4\n21    39   35    34   37  1.086315    2\n22    32   30    30   32  1.372791    3\n23    60   50    67   54  2.110873    9\n24    35   37    48   39  3.913168   18\n25    39   36    39   31  1.647245    5\n26    50   34    37   40  4.667263   21\n27    43   37    39   50  5.412107   22\n28    48   54    57   43  3.806908   17\n\n\n\n\n\nmi = (1/n)*t(jn)*y;\nprint 'Vetor de médias:' mi[format=5.2],,;\n\n\nDM2 = j(n,1,0);\ni=1;\ndo while (i&lt;=n);\nyi= Y[i,];\nDM = (yi-mi)*inv(Sigma)*t(yi-mi);\nDM2[i] = DM;\ni=i+1;\nend;\n\nrank = rank(DM2);\nprint\n\n\n'-----------------------------------------------------------------',\n'Distância de Mahalanobis de cada ponto (y) ao vetor de médias(mi)',\n'-----------------------------------------------------------------';\nprint ,,Y ' ' DM2[format=8.4] ' ' rank;\nquit;\n\nproc corr cov data=cork;\ntitle 'Matriz de variâncias e covariâncias utilizando proc corr';\nvar north east south west;\nrun;"
  },
  {
    "objectID": "exemplo2.1.html",
    "href": "exemplo2.1.html",
    "title": "\n2  Gráfico da Normal Bivariada\n",
    "section": "",
    "text": "Construiremos o gráfico da normal bivariada utilizando o pacote plotly. Este pacote permite confeccionar gráficos dinâmicos tridimensionais.\n\ninstall.packages(\"plotly\")\n\n\nlibrary(plotly)\n\n\n\nR\nSAS\n\n\n\nPara construir o gráfico da normal bivariada, primeiramente, definimos os valores dos vetores das variáveis y1 e y2.\n\ny1 &lt;- seq(from = -4, to = 4, by = 0.1)\ny1\n\n [1] -4.0 -3.9 -3.8 -3.7 -3.6 -3.5 -3.4 -3.3 -3.2 -3.1 -3.0 -2.9 -2.8 -2.7 -2.6\n[16] -2.5 -2.4 -2.3 -2.2 -2.1 -2.0 -1.9 -1.8 -1.7 -1.6 -1.5 -1.4 -1.3 -1.2 -1.1\n[31] -1.0 -0.9 -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1  0.2  0.3  0.4\n[46]  0.5  0.6  0.7  0.8  0.9  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9\n[61]  2.0  2.1  2.2  2.3  2.4  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4\n[76]  3.5  3.6  3.7  3.8  3.9  4.0\n\ny2 &lt;- seq(from = -4, to = 4, by = 0.1)\ny2\n\n [1] -4.0 -3.9 -3.8 -3.7 -3.6 -3.5 -3.4 -3.3 -3.2 -3.1 -3.0 -2.9 -2.8 -2.7 -2.6\n[16] -2.5 -2.4 -2.3 -2.2 -2.1 -2.0 -1.9 -1.8 -1.7 -1.6 -1.5 -1.4 -1.3 -1.2 -1.1\n[31] -1.0 -0.9 -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1  0.2  0.3  0.4\n[46]  0.5  0.6  0.7  0.8  0.9  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9\n[61]  2.0  2.1  2.2  2.3  2.4  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4\n[76]  3.5  3.6  3.7  3.8  3.9  4.0\n\n\nA função seq() cria uma sequência de valores e possui três argumentos:\n\nfrom =: valor em que a sequência começa;\nto =: valor em que a sequência termina;\nby =: de quanto em quanto a sequência é construída.\n\nEm seguida, calculamos a densidade bivariada, dada pela seguinte equação:\n\\[\n\\phi = \\frac{1}{2\\pi \\sqrt{1-r^2}} exp\\left\\{-\\frac{y_1^2 - 2r y_1 y_2 + y_2^2}{2(1-r^2)}\\right\\}\n\\]\nem que \\(r\\) é o coeficiente de correlação entre y1 e y2, variando de -1 a 1.\nO valor do coeficiente de correlação será salvo no objeto r. Já o objeto pi armazena o valor de \\(\\pi\\) com seis casas decimais.\n\nr &lt;- -0.75  # Modificar este valor para verificar as alterações gráficas\npi\n\n[1] 3.141593\n\n\nPara realizar o cálculo da densidade bivariada no R, criamos uma função (function()) que executa a equação definida anteriormente para cada um dos valores de y1 e y2, gerando a matriz final, salva no objeto z.\n\nz &lt;- outer(y1, y2, function(y1,y2) { \n  phi &lt;- 1/(2 * pi * sqrt(1 - r^2)) * exp(-(y1^2 - 2 * r * y1 * y2 + y2^2) / (2 * (1 - r^2)))\n  return(phi)\n})\n\nCom isso, podemos criar o gráfico de densidade bivariada.\n\nplot_ly(x = y1, y = y2, z = z, type = \"surface\") |&gt; \n  layout(title = paste(\"Densidade Normal Bivariada (r =\", r, \")\"))\n\n\n\n\n\nCom a função plot_ly(), definimos os objetos que compõem os eixos x, y e z, além do estilo do gráfico (type = \"surface\"). Em seguida, utilizando a função layout(), inserimos o título do gráfico.\nLink para aplicativo: &lt;&gt;\n\n\n\n%let r=-0.75; * Fixa o coeficiente de correlação entre y1 e y2;\ndata Normal;\n pi=3.1416;\n do y1=-4 to 4 by 0.1;\n  do y2=-4 to 4 by 0.1; \n  phi=exp(-(y1*y1-2*&r*y1*y2+y2*y2)/2/(1-&r*&r))/2/pi/sqrt(1-&r*&r);\n  output;\n  end;\n end;\nrun;\n\ngoptions reset=all border;\nproc g3d data=Normal;\n title 'Densidade Normal Bivariada (r =' &r ')';\n plot y1*y2=phi / rotate=-20;\nrun;"
  },
  {
    "objectID": "exemplo2.2.html#exemplo-1-4.4a",
    "href": "exemplo2.2.html#exemplo-1-4.4a",
    "title": "\n3  Propriedades\n",
    "section": "\n3.1 Exemplo 1 (4.4(a))",
    "text": "3.1 Exemplo 1 (4.4(a))\nPara os exemplos dos Teoremas 1, 2 e 3 considere um vetor aleatório \\(\\mathbf{y} \\sim N_3(\\mathbf{\\mu}, \\mathbf{\\Sigma})\\), em que:\n\\[\n\\mathbf{\\mu} =\n  \\begin{bmatrix}\n  3 \\\\ 1 \\\\ 2\n  \\end{bmatrix}\n\\space e \\space\n\\mathbf{\\Sigma} =\n  \\begin{bmatrix}\n   4 & 0 & 2 \\\\\n   0 & 1 & -1 \\\\\n   2 & -1 & 3 \\\\\n   \\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\n\nmi &lt;- c(3, 1, 2)\nmi\n\n[1] 3 1 2\n\nSigma &lt;- matrix(c(4, 0, 2, 0, 1, -1, 2, -1, 3), nrow = 3, ncol = 3)\nSigma\n\n     [,1] [,2] [,3]\n[1,]    4    0    2\n[2,]    0    1   -1\n[3,]    2   -1    3\n\n\n\n\n\noptions nocenter ps=1000;\nproc iml;\nreset fuzz;\n\ny = {'y1','y2','y3'};\nmi = {3,1,2};\nSigma = {4 0 2, 0 1 -1, 2 -1 3};\n\n\n\n\n\n3.1.1 Teorema 1.1 (4.4A. i)\nSejam \\(\\mathbf{y} \\sim N_p(\\mathbf{\\mu}, \\mathbf{\\Sigma})\\) e \\(\\mathbf{a}\\) um vetor \\(p \\times 1\\) de constantes. Então, a variável aleatória:\n\\[z = \\mathbf{a'}\\mathbf{y} \\sim N(\\mathbf{a' \\mu}, \\mathbf{a'\\Sigma a})\\]\nComo exemplo, considere:\n\\[\nz = y_1 - 2y_2 + y_3\n\\text{ ,   em que }\n\\mathbf{a} =\n  \\begin{bmatrix}\n    1 \\\\ -2 \\\\ 1\n  \\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\n\na &lt;- c(1, -2, 1)\na\n\n[1]  1 -2  1\n\nE_z &lt;- t(a) %*% mi\nE_z\n\n     [,1]\n[1,]    3\n\nvar_z &lt;- t(a) %*% Sigma %*% a\nvar_z\n\n     [,1]\n[1,]   19\n\n\nCom isso, a variável aleatória \\(z\\) fica:\n\\[z = \\mathbf{a'y} \\sim N(\\mathbf{a' \\mu} = 3, \\mathbf{a'\\Sigma a} = 19)\\]\n\n\n\na = {1, -2, 1};\nmi_z = t(a) * mi;\nvar_z = t(a)*Sigma*a;\nprint y mi Sigma,,,,, 'item (i)   ',,'z = y1-2y2+y3   ' mi_z var_z;\n\n\n\n\n\n3.1.2 Teorema 1.2 (4.4A. ii)\nSejam \\(\\mathbf{y} \\sim N_p(\\mathbf{\\mu}, \\mathbf{\\Sigma})\\) e \\(\\mathbf{A}\\) uma matriz \\(k \\times p\\) de constantes e posto \\(k \\le p\\). Então, o vetor aleatório:\n\\[\\mathbf{z} = \\mathbf{A} \\mathbf{y} \\sim N_k(\\mathbf{A \\mu}, \\mathbf{A\\Sigma A'})\\]\nAgora, considere as seguintes combinações lineares \\(z_1\\) e \\(z_2\\):\n\\[\n\\begin{aligned}\nz_1 = y_1 - y_2 + y_3 \\space \\text{ e } \\space z_2 = 3y_1 + y_2 - 2y_3 \\\\\n\\mathbf{z} =\n\\begin{bmatrix}\n\\mathbf{z_1} \\\\ \\mathbf{z_2}\n\\end{bmatrix}\n\\text{ = }\n\\begin{bmatrix}\n1 & -1 & 1 \\\\\n3 & 1 & -2\n\\end{bmatrix}\n\\begin{bmatrix}\ny_1 \\\\ y_2 \\\\ y_3\n\\end{bmatrix}\n\\text{ = }\n\\mathbf{Ay}\n\\end{aligned}\n\\]\n\n\nR\nSAS\n\n\n\n\nA &lt;- matrix(c(1, -1, 1, 3, 1, -2), nrow = 2, ncol = 3, byrow = TRUE)\nA\n\n     [,1] [,2] [,3]\n[1,]    1   -1    1\n[2,]    3    1   -2\n\nE_z1z2 &lt;- A %*% mi\nE_z1z2\n\n     [,1]\n[1,]    4\n[2,]    6\n\ncov_z1z2 &lt;- A %*% Sigma %*% t(A)\ncov_z1z2\n\n     [,1] [,2]\n[1,]   14    4\n[2,]    4   29\n\n\nPelo teorema, o vetor aleatório fica:\n\\[\n\\mathbf{z} = \\mathbf{Ay} \\sim N_2\n\\left(\n  \\mathbf{A \\mu} =\n    \\begin{bmatrix}\n      4 \\\\ 6\n    \\end{bmatrix},\n  \\mathbf{A\\Sigma A'} =\n    \\begin{bmatrix}\n      14 & 4 \\\\\n      4 & 29\n    \\end{bmatrix}\n\\right)\n\\]\n\n\n\nZZ = {'z1 = y1-y2+y3','z2 = 3y1+y2-2y3'}; \nA = {1 -1  1, 3  1 -2};\nmi_ZZ = A*mi;\nSigma_ZZ = A*Sigma*t(A);\nprint 'item (ii)',,  ZZ '     ' mi_ZZ '     ' Sigma_ZZ;\n\n\n\n\n\n3.1.3 Teorema 2 (4.4B.)\nSe \\(\\mathbf{y} \\sim N_p(\\mathbf{\\mu, \\Sigma})\\), então qualquer subvetor \\(r \\times 1\\) de \\(\\mathbf{y}\\) tem uma distribuição normal \\(r\\)-variada com médias, variâncias e covariâncias iguais às da distribuição normal \\(p\\)-variada original.\nComo exmeplo, considere: \\(y_1 \\sim N(3,4)\\), \\(y_2 \\sim N(1,1)\\) e \\(y_3 \\sim N(2, 3)\\).\n\n\nR\nSAS\n\n\n\nDessa forma, o vetor \\(\\begin{bmatrix} y_1 \\\\ y_2\\end{bmatrix}\\):\n\nA12 &lt;- matrix(c(1, 0, 0, 0, 1, 0), nrow = 2, ncol = 3, byrow = TRUE)\nA12\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n\nmi_12 &lt;- A12 %*% mi\nmi_12\n\n     [,1]\n[1,]    3\n[2,]    1\n\nSigma_12 &lt;- A12 %*% Sigma %*% t(A12)\nSigma_12\n\n     [,1] [,2]\n[1,]    4    0\n[2,]    0    1\n\n\n\\[\n\\begin{bmatrix}\n  y_1 \\\\ y_2\n\\end{bmatrix}\n  \\sim N_2\\left(\n    \\begin{bmatrix}\n      3 \\\\ 1\n    \\end{bmatrix},\n    \\begin{bmatrix}\n      4 & 0 \\\\\n      0 & 1\n    \\end{bmatrix}\n  \\right) \\\\\n\\]\nEnquanto isso, o vetor \\(\\begin{bmatrix} y_1 \\\\ y_3\\end{bmatrix}\\):\n\nA13 &lt;- matrix(c(1, 0, 0, 0, 0, 1), nrow = 2, ncol = 3, byrow = TRUE)\nA13\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    0    1\n\nmi_13 &lt;- A13 %*% mi\nmi_13\n\n     [,1]\n[1,]    3\n[2,]    2\n\nSigma_13 &lt;- A13 %*% Sigma %*% t(A13)\nSigma_13\n\n     [,1] [,2]\n[1,]    4    2\n[2,]    2    3\n\n\n\\[\n\\begin{bmatrix}\n  y_1 \\\\ y_3\n\\end{bmatrix}\n  \\sim N_2\\left(\n    \\begin{bmatrix}\n      3 \\\\ 2\n    \\end{bmatrix},\n    \\begin{bmatrix}\n      4 & 2 \\\\\n      2 & 3\n    \\end{bmatrix}\n  \\right)\n\\]\n\n\n\nA12 = {1 0 0, 0 1 0};\nmi_12 = A12*mi;\nSigma_12 = A12*Sigma*t(A12);\nprint mi_12 Sigma_12;\n\nA13 = {1 0 0, 0 0 1};\nmi_13 = A13*mi;\nSigma_13 = A13*Sigma*t(A13);\nprint mi_13 Sigma_13;\n\n\n\n\n\n3.1.4 Teorema 3 (4.4C.)\nSe o vetor particionado \\(\\mathbf{v} = \\begin{bmatrix} \\mathbf{y} \\\\ \\mathbf{x} \\end{bmatrix} \\sim N_{p+q}(\\mathbf{\\mu, \\Sigma})\\) então os subvetores aleatórios \\(\\mathbf{y}\\) e \\(\\mathbf{x}\\) são independentes se \\(\\mathbf{\\Sigma}_{xy} = 0\\).\n\n\nR\nSAS\n\n\n\n\na1 &lt;- c(1, 0, 0)\na1\n\n[1] 1 0 0\n\nb2 &lt;- c(0, 1, 0)\nb2\n\n[1] 0 1 0\n\ncov_12 &lt;- t(a1) %*% Sigma %*% b2\ncov_12\n\n     [,1]\n[1,]    0\n\n\n\n\n\na1 = {1 0 0};\nb2 = {0 1 0};\ncov_12 = a1*Sigma*t(b2);\nprint cov_12;"
  },
  {
    "objectID": "exemplo2.2.html#exemplo-2-4.4b",
    "href": "exemplo2.2.html#exemplo-2-4.4b",
    "title": "\n3  Propriedades\n",
    "section": "\n3.2 Exemplo 2 (4.4(b))",
    "text": "3.2 Exemplo 2 (4.4(b))\n\n3.2.1 Teorema 4 (4.4D.)\nSe \\(\\mathbf{y}\\) e \\(\\mathbf{x}\\) têm distribuição conjunta normal multivariada com \\(\\mathbf{\\Sigma}_{yx} \\ne 0\\) então a distribuição condicional de \\(\\mathbf{y}\\) dado \\(\\mathbf{x}\\), \\(f(\\mathbf{y} \\mid \\mathbf{x})\\), é normal multivariada com vetor de médias e matriz de covariâncias dados por:\n\\[\n\\begin{aligned}\nE(\\mathbf{y} \\mid \\mathbf{x}) = \\mathbf{\\mu}_y + \\mathbf{\\Sigma}_{yx} \\mathbf{\\Sigma}_{xx}^{-1}(\\mathbf{x} - \\mathbf{\\mu}_x) \\\\\ncov(\\mathbf{y} \\mid \\mathbf{x}) = \\mathbf{\\Sigma}_{yy} - \\mathbf{\\Sigma}_{yx} \\mathbf{\\Sigma}_{xx}^{-1} \\mathbf{\\Sigma}_{xy}\n\\end{aligned}\n\\]\nPara ilustrar o Teorema 4 (4.4D.), considere o vetor aleatório \\(\\mathbf{v} \\sim N_4(\\mathbf{\\mu, \\Sigma})\\) em que:\n\\[\n\\begin{aligned}\n\\mathbf{\\mu} =\n\\begin{bmatrix}\n2 \\\\ 5 \\\\ -2 \\\\ 1\n\\end{bmatrix}\n\\text{ e }\n\\mathbf{\\Sigma} =\n\\begin{bmatrix}\n9 & 0 & 3 & 3 \\\\\n0 & 1 & -1 & 2 \\\\\n3 & -1 & 6 & -3 \\\\\n3 & 2 & -3 & 7 \\\\\n\\end{bmatrix}\n\\end{aligned}\n\\]\n\n\nR\nSAS\n\n\n\n\nmi &lt;- c(2, 5, -2, 1)\nmi\n\n[1]  2  5 -2  1\n\nSigma &lt;- matrix(\n  c(9, 0, 3, 3, 0, 1, -1, 2, 3, -1, 6, -3, 3, 2, -3, 7), \n  nrow = 4, byrow = TRUE\n  )\nSigma\n\n     [,1] [,2] [,3] [,4]\n[1,]    9    0    3    3\n[2,]    0    1   -1    2\n[3,]    3   -1    6   -3\n[4,]    3    2   -3    7\n\n\n\n\n\noptions nocenter ps=1000;\nproc iml;\nreset fuzz;\n\nmi = {2,5,-2,1};\nSigma = {9 0 3 3, 0 1 -1 2, 3 -1 6 -3, 3 2 -3 7};\nprint v mi Sigma;\n\n\n\n\nSe \\(\\mathbf{v} = \\begin{bmatrix} y_1, y_2, x_1, x_2 \\end{bmatrix} '\\) é um vetor particionado dessa forma, então:\n\\[\n\\mathbf{\\mu_y} =\n\\begin{bmatrix}\n2 \\\\ 5\n\\end{bmatrix}\n,\n\\mathbf{\\mu_x} =\n\\begin{bmatrix}\n-2 \\\\ 1\n\\end{bmatrix} \\\\\n\\]\n\\[\n\\mathbf{\\Sigma_{yy}} =\n\\begin{bmatrix}\n9 & 0 \\\\ 0 & 1\n\\end{bmatrix}\n,\n\\mathbf{\\Sigma_{xx}}\n\\begin{bmatrix}\n6 & -3 \\\\ -3 & 7\n\\end{bmatrix}\n,\n\\mathbf{\\Sigma_{yx}}\n\\begin{bmatrix}\n3 & 3 \\\\ -1 & 2\n\\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\n\nAy &lt;- matrix(c(1, 0, 0, 0, 0, 1, 0, 0), nrow = 2, byrow = TRUE)\nAy\n\n     [,1] [,2] [,3] [,4]\n[1,]    1    0    0    0\n[2,]    0    1    0    0\n\nmi_y &lt;- Ay %*% mi\nmi_y\n\n     [,1]\n[1,]    2\n[2,]    5\n\nSigma_yy &lt;- Ay %*% Sigma %*% t(Ay)\nSigma_yy\n\n     [,1] [,2]\n[1,]    9    0\n[2,]    0    1\n\nAx &lt;- matrix(c(0, 0, 1, 0, 0, 0, 0, 1), nrow = 2, byrow = TRUE)\nAx\n\n     [,1] [,2] [,3] [,4]\n[1,]    0    0    1    0\n[2,]    0    0    0    1\n\nmi_x &lt;- Ax %*% mi\nmi_x\n\n     [,1]\n[1,]   -2\n[2,]    1\n\nSigma_xx &lt;- Ax %*%Sigma %*% t(Ax)\nSigma_xx\n\n     [,1] [,2]\n[1,]    6   -3\n[2,]   -3    7\n\nSigma_yx &lt;- Ay %*% Sigma %*% t(Ax)\nSigma_yx\n\n     [,1] [,2]\n[1,]    3    3\n[2,]   -1    2\n\n\n\n\n\nAy = {1 0 0 0, 0 1 0 0};\nmi_y = Ay*mi;\nSigma_yy = Ay*Sigma*t(Ay);\n\nAx = {0 0 1 0, 0 0 0 1};\nmi_x = Ax*mi;\nSigma_xx = Ax*Sigma*t(Ax);\n\nSigma_yx = Ay*Sigma*t(Ax);\nprint mi_y Sigma_yy,, mi_x Sigma_xx,, Sigma_yx;\n\n\n\n\nPara calcular \\(cov(\\mathbf{y} \\mid \\mathbf{x}) = \\mathbf{\\Sigma}_{yy} - \\mathbf{\\Sigma}_{yx} \\mathbf{\\Sigma}_{xx}^{-1} \\mathbf{\\Sigma}_{xy}\\) procedemos da seguinte maneira:\n\n\nR\nSAS\n\n\n\n\ncov_ydx &lt;- Sigma_yy - Sigma_yx %*% solve(Sigma_xx) %*% t(Sigma_yx)\ncov_ydx\n\n           [,1]       [,2]\n[1,]  3.8181818 -0.7272727\n[2,] -0.7272727  0.4242424\n\n\n\\[ cov(\\mathbf{y} \\mid \\mathbf{x}) = 3.82, -0.73, -0.73, 0.42 \\]\n\n\n\ncov_ydx = Sigma_yy-Sigma_yx*inv(Sigma_xx)*t(Sigma_yx);\n\nprint Sigma_yy[format=6.0],, cov_ydx[format=6.2];\n\n\n\n\nNote que a variância de \\(y_1\\) e de \\(y_2\\) são maiores do que as variâncias condicionais:\n\nSigma_yy\n\n     [,1] [,2]\n[1,]    9    0\n[2,]    0    1\n\ncov_ydx\n\n           [,1]       [,2]\n[1,]  3.8181818 -0.7272727\n[2,] -0.7272727  0.4242424\n\n\n\\[\n\\begin{aligned}\nvar(y_1) = 9 \\text{ e } var(y_1 \\mid x_1, x_2) = 3,82 \\\\\nvar(y_2) = 1 \\text{ e } var(y_2 \\mid x_1, x_2) = 0,42\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "exemplo2.2.html#exemplo-3-4.4c",
    "href": "exemplo2.2.html#exemplo-3-4.4c",
    "title": "\n3  Propriedades\n",
    "section": "\n3.3 Exemplo 3 (4.4(c))",
    "text": "3.3 Exemplo 3 (4.4(c))\n\n3.3.1 Teorema 4 (4.4D.) - Corolário 1\nConsidere:\n\\[\n\\mathbf{v} =\n\\begin{bmatrix}\ny, & x_1, & \\dots, & x_q\n\\end{bmatrix}\n' =\n\\begin{bmatrix}\ny \\\\ \\mathbf{x'}\n\\end{bmatrix}\n\\text{ com }\n\\mathbf{\\mu} =\n\\begin{bmatrix}\n\\mu_y \\\\ \\mathbf{\\mu_x}\n\\end{bmatrix}\n\\text{ e }\n\\mathbf{\\Sigma} =\n\\begin{bmatrix}\n\\sigma_y^2 & \\mathbf{\\sigma}_{yx}' \\\\\n\\mathbf{\\sigma}_{yx} & \\mathbf{\\Sigma}_{xx}\n\\end{bmatrix}\n\\text{, }\n\\]\nentão \\(y \\mid \\mathbf{x}\\) tem distribuição normal univariada com:\n\\[\n\\begin{aligned}\nE(y \\mid \\mathbf{x}) = \\mu_y + \\mathbf{\\sigma}_{yx}' \\mathbf{\\Sigma}_{xx}^{-1} (\\mathbf{x} - \\mathbf{\\mu}_x) \\\\\nvar(y \\mid \\mathbf{x}) = \\sigma_{y}^2 - \\mathbf{\\sigma}_{yx}' \\mathbf{\\Sigma}_{xx}^{-1} \\mathbf{\\sigma}_{yx}\n\\end{aligned}\n\\]\nComo exemplo, seguimos com o vetor utilizado no Teorema 4 (4.4D) 3.2.1.\n\\[\n\\mathbf{v} \\sim N_4(\\mathbf{\\mu}, \\mathbf{\\Sigma})\n\\text{ , }\n\\mathbf{\\mu} =\n\\begin{bmatrix}\n2 \\\\ 5 \\\\ -2 \\\\ 1\n\\end{bmatrix}\n\\text{ e }\n\\mathbf{\\Sigma} =\n\\begin{bmatrix}\n9 & 0 & 3 & 3 \\\\\n0 & 1 & -1 & 2 \\\\\n3 & -1 & 6 & -3 \\\\\n3 & 2 & -3 & 7 \\\\\n\\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\n\nmi &lt;- c(2, 5, -2, 1)\nmi\n\n[1]  2  5 -2  1\n\nSigma &lt;- matrix(\n  c(9, 0, 3, 3, 0, 1, -1, 2, 3, -1, 6, -3, 3, 2, -3, 7), \n  nrow = 4, byrow = TRUE\n  )\nSigma\n\n     [,1] [,2] [,3] [,4]\n[1,]    9    0    3    3\n[2,]    0    1   -1    2\n[3,]    3   -1    6   -3\n[4,]    3    2   -3    7\n\n\n\n\n\noptions nocenter ps=1000;\nproc iml;\nreset fuzz;\n\nmi = {2,5,-2,1};\nSigma = {9 0 3 3, 0 1 -1 2, 3 -1 6 -3, 3 2 -3 7};\nprint v mi Sigma;\n\n\n\n\nSe \\(\\mathbf{v} = \\begin{bmatrix} y, & x_1, & x_2, & x_3 \\end{bmatrix}'\\) então:\n\\[\\mu_y = 2 \\text{ e } var(y) = 9 \\\\\\]\n\\[\n\\mathbf{\\mu}_x =\n\\begin{bmatrix}\n5 \\\\ -2 \\\\ 1\n\\end{bmatrix}\n\\text{ , }\n\\mathbf{\\Sigma}_{xx} =\n\\begin{bmatrix}\n1 & -1 & 2 \\\\\n-1 & 6 & -3 \\\\\n2 & -3 & 7\n\\end{bmatrix}\n\\text{ e }\n\\mathbf{\\sigma}_{yx} =\n\\begin{bmatrix}\n0 \\\\ 3 \\\\ 3\n\\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\n\nAy &lt;- matrix(c(1, 0, 0, 0), nrow = 1)\nAy\n\n     [,1] [,2] [,3] [,4]\n[1,]    1    0    0    0\n\nmi_y &lt;- Ay %*% mi\nmi_y\n\n     [,1]\n[1,]    2\n\nSigma_yy &lt;- Ay %*% Sigma %*% t(Ay)\nSigma_yy\n\n     [,1]\n[1,]    9\n\nAx &lt;- matrix(\n  c(0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), \n  nrow = 3, ncol = 4, byrow = TRUE\n)\nAx\n\n     [,1] [,2] [,3] [,4]\n[1,]    0    1    0    0\n[2,]    0    0    1    0\n[3,]    0    0    0    1\n\nmi_x &lt;- Ax %*% mi\nmi_x\n\n     [,1]\n[1,]    5\n[2,]   -2\n[3,]    1\n\nSigma_xx &lt;- Ax %*% Sigma %*% t(Ax)\nSigma_xx\n\n     [,1] [,2] [,3]\n[1,]    1   -1    2\n[2,]   -1    6   -3\n[3,]    2   -3    7\n\nsigma_yx &lt;- Ay %*% Sigma %*% t(Ax)\nsigma_yx\n\n     [,1] [,2] [,3]\n[1,]    0    3    3\n\n\n\n\n\nAy = {1 0 0 0};\nmi_y = Ay*mi;\nSigma_yy = Ay*Sigma*t(Ay);\n\nAx = {0 1 0 0, 0 0 1 0, 0 0 0 1};\nmi_x = Ax*mi;\nSigma_xx = Ax*Sigma*t(Ax);\n\nSigma_yx = Ay*Sigma*t(Ax);\nprint mi_y Sigma_yy,, mi_x Sigma_xx,, Sigma_yx;\n\n\n\n\nPelo Corolário, temos:\n\\[\nvar(y \\mid x_1, x_2, x_3) = \\sigma_{y}^2 - \\mathbf{\\sigma}_{yx}' \\mathbf{\\Sigma}_{xx}^{-1} \\mathbf{\\sigma}_{yx}\n\\]\n\n\nR\nSAS\n\n\n\n\ncov_ydx &lt;- Sigma_yy - sigma_yx %*% solve(Sigma_xx) %*% t(sigma_yx)\ncov_ydx\n\n         [,1]\n[1,] 2.571429\n\n\nPortanto, \\(var(y \\mid x_1, x_2, x_3) = 2.571\\).\nNote que a variância de \\(y\\) é maior do que a variância condicional:\n\nSigma_yy\n\n     [,1]\n[1,]    9\n\ncov_ydx\n\n         [,1]\n[1,] 2.571429\n\n\n\\[\n\\begin{aligned}\nvar(y) = 2.571 \\\\\nvar(y \\mid x_1, x_2, x_3) = 2.571\n\\end{aligned}\n\\]\n\n\n\ncov_ydx = Sigma_yy-Sigma_yx*inv(Sigma_xx)*t(Sigma_yx);\n\nprint Sigma_yy[format=6.0],, cov_ydx[format=6.2];"
  },
  {
    "objectID": "exemplo2.3.html",
    "href": "exemplo2.3.html",
    "title": "\n4  Correlação Parcial\n",
    "section": "",
    "text": "Considere um vetor \\(\\mathbf{v}\\), formado por um subconjunto de \\(y's\\) que inclui \\(y_1\\) e \\(y_2\\), sendo denotado por \\(\\mathbf{y}\\). O outro subconjunto de \\(y's\\) que inclui \\(y_3\\) e \\(y_4\\) é denotado por \\(\\mathbf{x}\\).\n\\[\n\\mathbf{v} =\n\\begin{bmatrix}\n\\mathbf{y} \\\\ \\mathbf{x}\n\\end{bmatrix}\n\\text{, em que }\n\\mathbf{y} =\n\\begin{bmatrix}\ny_1, ..., y_2\n\\end{bmatrix}\n\\text{'  e  }\n\\mathbf{x} =\n\\begin{bmatrix}\ny_3, ..., y_4\n\\end{bmatrix}\n\\text{'}\n\\]\nVamos comparar o coeficiente de correlação parcial entre \\(y_1\\) e \\(y_2\\) (\\(\\rho_{12}\\)) com o coeficiente de correlação parcial condicional de \\(y_1\\) e \\(y_2\\) dado \\(y_3\\) e \\(y_4\\) (\\(\\rho_{12.34}\\)).\nPara isso, utilizaremos a seguinte matriz de variâncias e covariâncias:\n\\[\n\\mathbf{\\Sigma} =\n  \\begin{bmatrix}\n    9 & 0 & 3 & 3 \\\\\n    0 & 1 & -1 & 2 \\\\\n    3 & -1 & 6 & -3 \\\\\n    3 & 2 & -3 & 7 \\\\\n   \\end{bmatrix}\n\\text{.}\n\\]\nPrimeiramente, calcularemos a correlação linear entre as variáveis \\(y_1\\) e \\(y_2\\), ou seja, \\(\\rho_{12}\\).\n\n\nR\nSAS\n\n\n\nCom a matriz de variâncias e covariâncias salva no objeto Sigma, calculamos a raiz quadrada da diagonal de Sigma, ou seja, a raiz quadrada das variâncias (D).\n\nSigma &lt;- matrix(\n  c(9, 0, 3, 3, 0, 1, -1, 2, 3, -1, 6, -3, 3, 2, -3, 7), \n  nrow = 4, byrow = TRUE\n)\nSigma\n\n     [,1] [,2] [,3] [,4]\n[1,]    9    0    3    3\n[2,]    0    1   -1    2\n[3,]    3   -1    6   -3\n[4,]    3    2   -3    7\n\nD &lt;- sqrt(diag(Sigma))\nD\n\n[1] 3.000000 1.000000 2.449490 2.645751\n\n\nCom a raiz quadrada das variâncias (D), calculamos os coeficientes de correlação por meio da seguinte expressão:\n\\[\\mathbf{\\rho} = \\mathbf{D}_{\\sigma}^{-1} \\mathbf{\\Sigma} \\mathbf{D}_{\\sigma}^{-1}\\]\n\nRo &lt;- solve(diag(D)) %*% Sigma %*% solve(diag(D))\nRo\n\n          [,1]       [,2]       [,3]       [,4]\n[1,] 1.0000000  0.0000000  0.4082483  0.3779645\n[2,] 0.0000000  1.0000000 -0.4082483  0.7559289\n[3,] 0.4082483 -0.4082483  1.0000000 -0.4629100\n[4,] 0.3779645  0.7559289 -0.4629100  1.0000000\n\n\nAssim, verificamos que as variáveis \\(y_1\\) e \\(y_2\\) são não correlacionadas (\\(\\rho_{12} = \\rho_{21} = 0\\)).\n\n\n\noptions nocenter ps=1000;\nproc iml;\nreset fuzz;\n\nSigma = {9  0  3  3, \n         0  1 -1  2, \n         3 -1  6 -3, \n         3  2 -3  7};\nD = sqrt(diag(Sigma));\nRo = inv(D)*Sigma*inv(D);\nprint Sigma '     ' Ro[format=6.2];\n\n\n\n\nPara calcular o coeficiente de correlação parcial entre \\(y_1\\) e \\(y_2\\) dada a condicional \\(y_3\\) e \\(y_4\\) (\\(\\rho_{12.34}\\)), particionaremos \\(\\Sigma\\) da seguinte maneira:\n\\[\n\\mathbf{\\Sigma}_{yy} =\n  \\begin{bmatrix}\n    9 & 0 \\\\\n    0 & 1\n  \\end{bmatrix}\n\\text{  ,  }\n\\mathbf{\\Sigma}_{xx} =\n  \\begin{bmatrix}\n    6 & -3 \\\\\n    -3 & 7\n  \\end{bmatrix}\n,\\mathbf{\\Sigma}_{yx} =\n  \\begin{bmatrix}\n    3 & 3 \\\\\n    -1 & 2\n  \\end{bmatrix}\n\\]\n\n\nR\nSAS\n\n\n\nPara particionar \\(\\mathbf{\\Sigma}\\), utilizaremos o Teorema 2 (4.4B.) 3.1.3.\nA primeira partição (\\(\\mathbf{\\Sigma}_{yy}\\)) fica:\n\nAy &lt;- matrix(c(1, 0, 0, 0, 0, 1, 0, 0), nrow = 2, byrow = T)\nAy\n\n     [,1] [,2] [,3] [,4]\n[1,]    1    0    0    0\n[2,]    0    1    0    0\n\nSigma_yy &lt;- Ay %*% Sigma %*% t(Ay)\nSigma_yy\n\n     [,1] [,2]\n[1,]    9    0\n[2,]    0    1\n\n\nNote que esta partição corresponde ao \\(\\rho_{12} = 0\\):\n\nDyy &lt;- sqrt(diag(Sigma_yy))\nDyy\n\n[1] 3 1\n\nRo_yy &lt;- solve(diag(Dyy)) %*% Sigma_yy %*% solve(diag(Dyy))\nRo_yy\n\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\n\nPara a partição \\(\\mathbf{\\Sigma}_{xx}\\) temos:\n\nAx &lt;- matrix(c(0, 0, 1, 0, 0, 0, 0, 1), nrow = 2, byrow = T)\nAx\n\n     [,1] [,2] [,3] [,4]\n[1,]    0    0    1    0\n[2,]    0    0    0    1\n\nSigma_xx &lt;- Ax %*% Sigma %*% t(Ax)\nSigma_xx\n\n     [,1] [,2]\n[1,]    6   -3\n[2,]   -3    7\n\n\nPor fim, a partição \\(\\mathbf{\\Sigma}_{yx}\\):\n\nSigma_yx &lt;- Ay %*% Sigma %*% t(Ax)\nSigma_yx\n\n     [,1] [,2]\n[1,]    3    3\n[2,]   -1    2\n\n\nUsando o Teorema 4 (4.4D) 3.2.1, obtemos a matriz de covariâncias condicionais de \\(y_1\\) e \\(y_2\\) dado \\(y_3\\) e \\(y_4\\):\n\\[cov(y \\mid x) = \\mathbf{\\Sigma}_{yy} - \\mathbf{\\Sigma}_{yx} \\mathbf{\\Sigma}_{xx}^{-1} \\mathbf{\\Sigma}_{xy}\\]\n\ncov_ydx &lt;- Sigma_yy - Sigma_yx %*% solve(Sigma_xx) %*% t(Sigma_yx)\ncov_ydx\n\n           [,1]       [,2]\n[1,]  3.8181818 -0.7272727\n[2,] -0.7272727  0.4242424\n\n\nNote que \\(\\mathbf{\\Sigma}\\) é uma matriz simétrica, logo \\(\\mathbf{\\Sigma}_{yx} = \\mathbf{\\Sigma}'_{xy} \\iff \\mathbf{\\Sigma}_{xy} = \\mathbf{\\Sigma}'_{yx}\\).\nAssim, podemos calcular o coeficiente de correlação parcial \\(\\rho_{12.34}\\):\n\nD &lt;- sqrt(diag(cov_ydx))\nD\n\n[1] 1.9540168 0.6513389\n\nRo_ydx &lt;- solve(diag(D)) %*% cov_ydx %*% solve(diag(D))\nRo_ydx\n\n           [,1]       [,2]\n[1,]  1.0000000 -0.5714286\n[2,] -0.5714286  1.0000000\n\n\nPortanto, conhecendo os valores de \\(y_3\\) e \\(y_4\\), a correlação parcial entre \\(y_1\\) e \\(y_2\\) é negativa (\\(\\rho_{12.34} = -0,571\\)) e diferente da correlação linear simples (\\(\\rho_{12} = 0\\)).\n\nRo_yy\n\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\nRo_ydx\n\n           [,1]       [,2]\n[1,]  1.0000000 -0.5714286\n[2,] -0.5714286  1.0000000\n\n\n\n\n\nAy = {1 0 0 0, 0 1 0 0};\nSigma_yy = Ay*Sigma*t(Ay);\nDyy = sqrt(diag(Sigma_yy));\nRo_yy = inv(Dyy)*Sigma_yy*inv(Dyy);\n\nAx = {0 0 1 0, 0 0 0 1};\nSigma_xx = Ax*Sigma*t(Ax);\n\nSigma_yx = Ay*Sigma*t(Ax);\n\ncov_ydx = Sigma_yy-Sigma_yx*inv(Sigma_xx)*t(Sigma_yx);\nD = sqrt(diag(cov_ydx));\nRo_ydx = inv(D)*cov_ydx*inv(D);\n\nprint Ro_yy[format=8.2] '    ' Ro_ydx[format=8.3];"
  }
]